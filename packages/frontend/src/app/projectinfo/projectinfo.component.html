<!--*ngFor="let userProject of userProjects ; index as i; first as isFirst" -->
<div
    class="flex flex-col bg-[radial-gradient(ellipse_at_right,_var(--tw-gradient-stops))] from-blue-400 to-secondary rounded-md shadow-md shadow-secondary hover:shadow-lg hover:shadow-primary transition ease-in-out delay-125 hover:cursor-pointer p-2"
>
    <!-- DIV PROJET NON EDITé -->

    <div
        class="flex flex-col"
        *ngIf="!isEditNewProject"
        (click)="userProjectClicked($event)"
    >
        <!-- bouton icône edit -->
        <div class="text-right">
            <button
                [disabled]="
                    !userProject.isprojectadmin &&
                    user.role.name != 'superadmin' &&
                    user.role.name != 'admin'
                "
                (click)="openEditionProject()"
                class="pr-2 mr-2 md:mr-1 text-grey4 hover:text-white"
            >
                <div
                    *ngIf="
                        userProject.isprojectadmin ||
                            user.role.name == 'admin' ||
                            user.role.name == 'superadmin';
                        then mayedit;
                        else maynotedit
                    "
                ></div>
                <ng-template #mayedit>
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        fill="none"
                        viewBox="0 0 24 24"
                        stroke-width="1.5"
                        stroke="currentColor"
                        class="w-5 h-5 md:w-6 md:h-6"
                    >
                        <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"
                        />
                    </svg>
                </ng-template>
                <ng-template #maynotedit>
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        fill="none"
                        viewBox="0 0 24 24"
                        stroke-width="0"
                        stroke="currentColor"
                        class="w-6 h-6 md:w-8 md:h-8"
                    >
                        <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"
                        />
                    </svg>
                </ng-template>
            </button>
        </div>

        <div class="h-2/3">
            <!-- titre projet-->
            <div
                class="flex items-center justify-center border-4 border-secondary text-secondary text-xs md:text-sm font-extrabold bg-tpkwhite rounded-md max-w-1 mx-4 p-3"
            >
                <h2 class="text-center">{{ userProject.project.name }}</h2>
            </div>
            <!-- image + delivery date -->
            <div
                class="flex items-center justify-around border-4 border-secondary bg-tpkwhite rounded-md mx-4 mt-1 sm:mt-2 p-3 h-5/6"
            >
                <!-- image -->
                <div
                    class="w-16 h-16 lg:w-20 lg:h-20 rounded-sm flex items-center"
                >
                    <div
                        *ngIf="!userProject.project.picture"
                        name="projet triptyk"
                    >
                        <svg
                            class="w-16 h-16 lg:w-20 lg:h-20"
                            viewBox="0 0 2481 3508"
                            version="1.1"
                            xmlns="http://www.w3.org/2000/svg"
                            xmlns:xlink="http://www.w3.org/1999/xlink"
                            xml:space="preserve"
                            xmlns:serif="http://www.serif.com/"
                            style="
                                fill-rule: evenodd;
                                clip-rule: evenodd;
                                stroke-linejoin: round;
                                stroke-miterlimit: 2;
                            "
                        >
                            <g transform="matrix(1,0,0,1,-7.18829,-193.689)">
                                <g transform="matrix(1,0,0,1,36.2397,78.2193)">
                                    <g
                                        transform="matrix(1.56044,0,0,1.58436,96.0666,299.356)"
                                    >
                                        <g>
                                            <g
                                                transform="matrix(-1.84297,0.739647,-0.597793,-1.48552,3328.41,4610.8)"
                                            >
                                                <path
                                                    d="M352.976,2880.03L702.235,2817.75L698.674,2786.84L349.416,2849.12L352.976,2880.03Z"
                                                    style="
                                                        fill: rgb(31, 113, 165);
                                                    "
                                                />
                                            </g>
                                            <g
                                                transform="matrix(9.80571e-17,1.60139,-1.60139,9.80571e-17,5333.92,-74.8989)"
                                            >
                                                <rect
                                                    x="372.73"
                                                    y="2820.52"
                                                    width="298.544"
                                                    height="31.223"
                                                    style="
                                                        fill: rgb(31, 113, 165);
                                                    "
                                                />
                                            </g>
                                            <g
                                                transform="matrix(1,0,0,1,-1057.14,-2090.03)"
                                            >
                                                <path
                                                    d="M2127.27,3029.2L1692.67,2653.06L1692.78,3184.36L1742.78,3184.35L1742.7,2762.48C1843.68,2849.88 2094.55,3067 2094.55,3067L2127.27,3029.2Z"
                                                    style="
                                                        fill: rgb(31, 113, 165);
                                                    "
                                                />
                                            </g>
                                            <g
                                                transform="matrix(9.80571e-17,1.60139,-1.60139,9.80571e-17,5066.26,140.477)"
                                            >
                                                <rect
                                                    x="372.73"
                                                    y="2820.52"
                                                    width="298.544"
                                                    height="31.223"
                                                    style="
                                                        fill: rgb(31, 113, 165);
                                                    "
                                                />
                                            </g>
                                        </g>
                                    </g>
                                    <g
                                        transform="matrix(2.08496,0,0,2.08496,-257.242,-1566.33)"
                                    >
                                        <path
                                            d="M1110.36,1964.52L1110.36,1145.42L291.259,1145.42L291.259,1964.52L1110.36,1964.52ZM1068.32,1187.46L1068.32,1922.48L333.3,1922.48L333.3,1187.46L1068.32,1187.46Z"
                                            style="fill: rgb(31, 113, 165)"
                                        />
                                    </g>
                                </g>
                                <g
                                    transform="matrix(1.39844,0,0,1.39844,-245.996,-1230.17)"
                                >
                                    <g>
                                        <g
                                            transform="matrix(1,0,0,1,452.842,3021.49)"
                                        >
                                            <path
                                                d="M148.177,-166.06L148.177,-213.004L2.235,-213.004L2.235,-166.06L47.583,-166.06L47.583,0L102.83,0L102.83,-166.06L148.177,-166.06Z"
                                                style="
                                                    fill: rgb(31, 113, 165);
                                                    fill-rule: nonzero;
                                                "
                                            />
                                            <path
                                                d="M172.767,-213.004L172.767,0L228.014,0L228.014,-81.753L281.025,0L349.685,0L282.941,-87.182C292.841,-89.098 304.018,-93.888 312.321,-101.872C322.86,-112.091 329.247,-128.058 329.247,-146.261C329.247,-163.186 323.179,-181.708 311.044,-194.163C295.396,-210.45 274.958,-213.004 258.99,-213.004L172.767,-213.004ZM228.014,-170.212L238.552,-170.212C250.687,-170.212 259.948,-167.018 265.058,-161.909C269.848,-157.438 272.403,-150.412 272.403,-144.025C272.403,-137.319 269.529,-130.294 265.377,-126.142C258.671,-119.755 246.855,-117.52 238.552,-117.52L228.014,-117.52L228.014,-170.212Z"
                                                style="
                                                    fill: rgb(31, 113, 165);
                                                    fill-rule: nonzero;
                                                "
                                            />
                                            <rect
                                                x="372.997"
                                                y="-213.004"
                                                width="55.247"
                                                height="213.004"
                                                style="
                                                    fill: rgb(31, 113, 165);
                                                    fill-rule: nonzero;
                                                "
                                            />
                                            <path
                                                d="M563.009,-70.576C579.615,-70.576 599.414,-72.811 616.02,-89.098C632.626,-105.385 634.862,-125.184 634.862,-142.109C634.862,-159.993 631.668,-177.876 615.062,-193.844C598.776,-209.492 579.615,-213.004 561.093,-213.004L472.953,-213.004L472.953,0L528.2,0L528.2,-70.576L563.009,-70.576ZM528.2,-168.296L547.041,-168.296C554.067,-168.296 564.286,-167.338 570.673,-160.632C576.421,-154.883 577.06,-147.219 577.06,-141.471C577.06,-136.361 576.741,-127.739 570.034,-121.991C563.328,-115.923 552.47,-115.284 546.722,-115.284L528.2,-115.284L528.2,-168.296Z"
                                                style="
                                                    fill: rgb(31, 113, 165);
                                                    fill-rule: nonzero;
                                                "
                                            />
                                        </g>
                                        <g
                                            transform="matrix(1,0,0,1,1099.52,3021.49)"
                                        >
                                            <path
                                                d="M148.177,-166.06L148.177,-213.004L2.235,-213.004L2.235,-166.06L47.583,-166.06L47.583,0L102.83,0L102.83,-166.06L148.177,-166.06Z"
                                                style="
                                                    fill: rgb(31, 113, 165);
                                                    fill-rule: nonzero;
                                                "
                                            />
                                            <path
                                                d="M231.527,0L287.093,0L287.093,-102.191L366.61,-213.004L299.547,-213.004L260.906,-154.883L220.669,-213.004L154.564,-213.004L231.527,-102.191L231.527,0Z"
                                                style="
                                                    fill: rgb(31, 113, 165);
                                                    fill-rule: nonzero;
                                                "
                                            />
                                            <path
                                                d="M440.38,-213.004L385.132,-213.004L385.132,0L440.38,0L440.38,-92.291L512.552,0L584.086,0L491.794,-112.091L576.421,-213.004L508.081,-213.004L440.38,-125.184L440.38,-213.004Z"
                                                style="
                                                    fill: rgb(31, 113, 165);
                                                    fill-rule: nonzero;
                                                "
                                            />
                                        </g>
                                    </g>
                                </g>
                            </g>
                        </svg>
                    </div>

                    <img
                        *ngIf="userProject.project.picture"
                        src="data:image/*;base64, {{
                            userProject.project.picture
                        }}"
                        alt="{{ userProject.project.name }}"
                    />
                </div>
                <!-- delivery date -->
                <div
                    class="rounded-sm w-3/5 h-5/6 bg-tpkwhite p-1 flex flex-col text-secondary items-center justify-center"
                >
                    <h3 class="font-semibold text-xs md:text-sm">
                        {{ 'infrascrum.project-info.start-date' | translate }}
                    </h3>
                    <p class="text-sm">
                        {{
                            userProject.project.startdate | date: 'dd-MMM-yyyy'
                        }}
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- DIV EDITION PROJET -->

    <form
        #projectForm="ngForm"
        id="ngFormUserProject"
        class="flex flex-col"
        *ngIf="isEditNewProject"
        (ngSubmit)="updateProjectModel(projectForm)"
    >
        <!-- bouton icône edit -->
        <div class="text-right">
            <button
                form="ngFormUserProject"
                class="pr-2 mr-2 md:mr-1 text-grey4 hover:text-white"
            >
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke-width="1.5"
                    stroke="currentColor"
                    class="w-4 h-4 md:w-6 md:h-6 text-tpkvalidate font-extrabold"
                >
                    <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        d="M4.5 12.75l6 6 9-13.5"
                    />
                </svg>
            </button>
        </div>

        <div class="h-2/3">
            <!-- titre projet-->
            <div
                class="flex items-center justify-center border-4 border-secondary text-secondary text-xs md:text-sm font-extrabold bg-tpkwhite rounded-md max-w-1 mx-4 p-1 h-1/4 xl:h-1/3"
            >
                <input
                    [(ngModel)]="userProject.project.name"
                    name="name"
                    class="w-full text-center p-1 border-secondary border-2 focus-visible:outline-none focus-visible:ring-secondary focus-visible:ring-1"
                    type="text"
                    value="{{ userProject.project.name }}"
                    placeholder="Project name"
                />
            </div>
            <!-- image + delivery date -->
            <div
                class="flex flex-col items-center justify-around border-4 border-secondary bg-tpkwhite rounded-md mx-4 mt-1 sm:mt-2 p-2"
            >
                <!-- image -->
                <div
                    class="flex flex-col items-center justify-center w-full text-xs px-1"
                >
                    <label
                        for="#ProjectPicture"
                        class="text-secondary text-xs font-bold pb-1"
                        >{{
                            'infrascrum.project-info.picture' | translate
                        }}</label
                    >
                    <img
                        (click)="PictureUploader.click()"
                        *ngIf="userProject.project.picture"
                        src="data:image/*;base64, {{
                            userProject.project.picture
                        }}"
                        alt="{{ userProject.project.name }}"
                        class="w-12 h-12 lg:w-16 lg:h-16 rounded-sm"
                    />
                    <!-- <input
                        [(ngModel)]="userProject.project.picture"
                        name="picture"
                        #ProjectPicture
                        type="text"
                        placeholder="Image url pour l'instant"
                    /> -->
                    <input
                        #PictureUploader
                        type="file"
                        class="w-full border-none bg-transparent outline-none placeholder:italic focus:outline-none"
                        (change)="onFileSelected($event)"
                    />
                </div>
                <!-- delivery date -->
                <div
                    class="rounded-sm w-4/5 bg-tpkwhite p-1 flex flex-col text-secondary items-center justify-center"
                >
                    <label class="text-xs font-bold pb-1">
                        {{ 'infrascrum.project-info.start-date' | translate }}
                    </label>
                    <input
                        [(ngModel)]="userProject.project.startdate"
                        name="startdate"
                        type="date"
                        class="border-secondary border-2 focus-visible:outline-none focus-visible:ring-secondary focus-visible:ring-2 text-sm"
                        value="{{
                            userProject.project.startdate | date: 'yyyy-MM-dd'
                        }}"
                    />
                </div>
            </div>
        </div>
    </form>
</div>
