<div
    class="fixed top-0 bg-primary flex justify-between h-20 md:h-32 w-screen z-50"
>
    <div class="w-1/3 flex justify-left ml-6 md:ml-8">
        <!-- logo triptyk -->
        <img
            routerLink=""
            class="w-16 h-24 md:w-24 md:h-36 mr-6 flex pb-3 hover:cursor-pointer"
            src="./../../assets/img/logos/tpk-logo-white.png"
            alt=""
        />
        <!-- select avec projets de l'utilisateur, venir boucler sur ses projets pour les afficher dedans -->
        <div
            *ngIf="loggedIn()"
            class="hidden sm:flex items-center justify-center sm:mr-2 sm:ml-16"
        >
            <select
                name="projects"
                id="selectMyProjects"
                class="w-36 h-6 md:w-40 md:h-8 lg:w-48 lg:h-10 text-secondary text-xs md:text-sm lg:text-lg bg-tpkwhite p-1 font-semibold rounded-md focus:ring-2 focus:ring-secondary"
                (change)="onChange($event)"
            >
                <option selected disabled hidden>
                    {{ 'infrascrum.header.option-project' | translate }}
                </option>
                <option
                    *ngFor="
                        let userProject of userProjects;
                        index as i;
                        first as isFirst
                    "
                    [value]="userProject['project']['id']"
                >
                    {{ userProject['project']['name'] }}
                </option>
            </select>
        </div>
    </div>

    <!-- titre page actuelle -->
    <div class="hidden md:flex items-center w-1/3 justify-center">
        <h1 class="text-white text-xl sm:text-2xl md:text-5xl font-bold">
            {{ title }}
        </h1>
    </div>

    <!-- boutons signup et login ou menu user et searchbar si connecté -->
    <div class="flex items-center text-white mr-6 md:mr-8 w-1/3 justify-end">
        <!-- signup et login -->
        <div
            *ngIf="!loggedIn()"
            class="text-md sm:text-xl md:text-2xl flex items-center ml-1"
        >
            <!-- Plus besoin du signup pour l'instant  -->

            <!-- <a
                routerLink="create-user"
                class="mr-3 group transition duration-300 pt-1"
                >Sign Up
                <span
                    class="block max-w-0 group-hover:max-w-full transition-all duration-500 h-0.5 bg-secondary"
                ></span>
            </a> -->

            <button
                type="button"
                routerLink="login"
                class="btn-hover tpkBlueBtn rounded-2xl px-3 py-2 md:px-4 md:py-3"
                (click)="onLoginClick()"
            >
                {{ 'infrascrum.header.login' | translate }}
            </button>
        </div>
        <!-- input search -->
        <div
            *ngIf="loggedIn()"
            class="hidden sm:flex items-center justify-start mr-6 sm:mr-28"
        >
            <input
                type="text"
                [placeholder]="'infrascrum.header.search' | translate"
                class="w-36 h-6 md:w-40 md:h-8 lg:w-48 lg:h-10 text-secondary text-xs md:text-sm lg:text-lg bg-tpkwhite p-2 font-semibold rounded-md placeholder-primary focus-visible:outline-none focus-visible:ring-secondary focus-visible:ring-2"
                list="userprojects"
            />
            <datalist id="userprojects">
                <option
                    *ngFor="
                        let userProject of userProjects;
                        index as i;
                        first as isFirst
                    "
                    [value]="userProject['project']['id']"
                >
                    {{ userProject['project']['name'] }}
                </option>
            </datalist>
        </div>
        <!-- Pastille user si login -->
        <div
            *ngIf="loggedIn()"
            (click)="toggleMenu()"
            class="rounded-full hover:cursor-pointer"
        >
            <div
                class="userChip relative w-12 h-12 sm:w-14 sm:h-14 md:w-16 md:h-16 rounded-full bg-secondary flex items-center justify-center border-2 border-tpkvalidate"
            >
                <!-- condition si photo, sinon span avec premiere lettre username -->
                <img
                    *ngIf="user.name"
                    class="rounded-full"
                    src="{{ user.picture }}"
                    alt="profile picture"
                />
                <span *ngIf="!user.name" class="text-2xl uppercase font-bold">{{
                    user.username | initialsName
                }}</span>
            </div>
            <!-- Sous-menu user -->
            <div
                *ngIf="isMenuOpen"
                (outsideClick)="isMenuOpen = false"
                class="sub-menu-wrapper absolute top-auto right-6 w-64 max-h-0 drop-shadow-lg z-50"
            >
                <div
                    class="sub-menu bg-secondary rounded-b-lg rounded-tl-lg p-5 m-3"
                >
                    <div
                        class="user-info flex items-center justify-center text-center cursor-default"
                    >
                        <div class="w-1/3">
                            <div
                                class="userChip w-12 h-12 mr-10 rounded-full bg-primary flex items-center justify-center"
                            >
                                <!-- condition si photo, sinon span avec première lettre  -->

                                <span class="text-2xl uppercase font-bold">{{
                                    user.username | initialsName
                                }}</span>
                            </div>
                        </div>
                        <div class="w-2/3">
                            <h3 class="text-lg text-white font-bold">
                                {{ user.username }}
                            </h3>
                        </div>
                    </div>
                    <hr class="border-none h-0.5 w-full bg-white mt-2 mb-2" />

                    <!-- Lien vers projets de l'utilisateur  -->
                    <a
                        routerLink="/projects"
                        class="sub-menu-link flex items-center justify-between text-white my-2 p-2 hover:bg-primary hover:text-white rounded-md"
                    >
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke-width="1.5"
                            stroke="currentColor"
                            class="w-8 h-8 mr-2"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                d="M20.25 14.15v4.25c0 1.094-.787 2.036-1.872 2.18-2.087.277-4.216.42-6.378.42s-4.291-.143-6.378-.42c-1.085-.144-1.872-1.086-1.872-2.18v-4.25m16.5 0a2.18 2.18 0 00.75-1.661V8.706c0-1.081-.768-2.015-1.837-2.175a48.114 48.114 0 00-3.413-.387m4.5 8.006c-.194.165-.42.295-.673.38A23.978 23.978 0 0112 15.75c-2.648 0-5.195-.429-7.577-1.22a2.016 2.016 0 01-.673-.38m0 0A2.18 2.18 0 013 12.489V8.706c0-1.081.768-2.015 1.837-2.175a48.111 48.111 0 013.413-.387m7.5 0V5.25A2.25 2.25 0 0013.5 3h-3a2.25 2.25 0 00-2.25 2.25v.894m7.5 0a48.667 48.667 0 00-7.5 0M12 12.75h.008v.008H12v-.008z"
                            />
                        </svg>

                        <p class="w-full">
                            {{
                                'infrascrum.header.sub-menu-projects'
                                    | translate
                            }}
                        </p>
                        <span>></span>
                    </a>

                    <!-- Lien profil / venir ajouter lien vers porfil user au lieu de index -->
                    <a
                        routerLink="/user-profile"
                        class="sub-menu-link flex items-center justify-between text-white my-2 p-2 hover:bg-primary hover:text-white rounded-md"
                    >
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke-width="1.5"
                            stroke="currentColor"
                            class="w-8 h-8 mr-2"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"
                            />
                        </svg>
                        <p class="w-full">
                            {{
                                'infrascrum.header.sub-menu-profil' | translate
                            }}
                        </p>
                        <span>></span>
                    </a>

                    <!-- Lien management users uniquement visible pour superadmin  -->
                    <a
                        *ngIf="isSuperadmin()"
                        routerLink="/admin"
                        class="sub-menu-link flex items-center justify-between text-white my-2 p-2 hover:bg-primary hover:text-white rounded-md"
                    >
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke-width="1.5"
                            stroke="currentColor"
                            class="w-8 h-8 mr-2"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                d="M18 18.72a9.094 9.094 0 003.741-.479 3 3 0 00-4.682-2.72m.94 3.198l.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0112 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 016 18.719m12 0a5.971 5.971 0 00-.941-3.197m0 0A5.995 5.995 0 0012 12.75a5.995 5.995 0 00-5.058 2.772m0 0a3 3 0 00-4.681 2.72 8.986 8.986 0 003.74.477m.94-3.197a5.971 5.971 0 00-.94 3.197M15 6.75a3 3 0 11-6 0 3 3 0 016 0zm6 3a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0zm-13.5 0a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0z"
                            />
                        </svg>

                        <p class="w-full">
                            {{ 'infrascrum.header.sub-menu-users' | translate }}
                        </p>
                        <span>></span>
                    </a>
                    <a
                        class="sub-menu-link flex text-white my-2 p-2 items-center hover:bg-primary hover:text-white rounded-md"
                    >
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke-width="1.5"
                            stroke="currentColor"
                            class="w-8 h-8 mr-2"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                d="M10.5 21l5.25-11.25L21 21m-9-3h7.5M3 5.621a48.474 48.474 0 016-.371m0 0c1.12 0 2.233.038 3.334.114M9 5.25V3m3.334 2.364C11.176 10.658 7.69 15.08 3 17.502m9.334-12.138c.896.061 1.785.147 2.666.257m-4.589 8.495a18.023 18.023 0 01-3.827-5.802"
                            />
                        </svg>

                        <p class="w-full">
                            <button translate (click)="changeLanguage()">
                                {{
                                    'infrascrum.header.sub-menu-language'
                                        | translate
                                }}
                            </button>
                        </p>
                        <span>></span>
                    </a>
                    <!-- Lien déconnexion -->
                    <a
                        routerLink="/index"
                        (click)="logOut()"
                        class="sub-menu-link flex text-white my-2 p-2 items-center hover:bg-tpkerror hover:text-white rounded-md"
                    >
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke-width="1.5"
                            stroke="currentColor"
                            class="w-8 h-8 mr-2"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                d="M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15M12 9l-3 3m0 0l3 3m-3-3h12.75"
                            />
                        </svg>

                        <p class="w-full">
                            {{
                                'infrascrum.header.sub-menu-logout' | translate
                            }}
                        </p>
                        <span></span>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
